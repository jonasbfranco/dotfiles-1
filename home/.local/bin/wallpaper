#!/usr/bin/env bash

[ ! -f $HOME/.envs ] && echo "WALLPAPERS=${HOME}/img" > $HOME/.envs
source $HOME/.envs
wallpaper=$(find "$WALLPAPERS" -type f | shuf -n 1)

desks=('i3' 'xfce4-session')
for desk in "${desks[@]}"; do
	[ $(ps -eo comm | grep $desk) ] && desktop=$desk || desktop='outro'
done

if [ ! $1 ]; then
	if [ "$desktop" == "outro" ]; then
		feh --bg-fill "$wallpaper"
	elif [ "$desktop" == "xfce4-session" ]; then
		/usr/bin/xfconf-query -c xfce4-desktop -p /backdrop/screen0/monitor0/workspace0/last-image -s "$wallpaper"
	fi
else
	wallpaper=$(/usr/bin/xfconf-query -c xfce4-desktop -p /backdrop/screen0/monitor0/workspace0/last-image)
	yad --image dialog-question --title 'Atenção' --button=gtk-yes:0 --button=gtk-no:1 --text "Deseja apagar $(basename $wallpaper)?"
	if [ $? = 0 ]; then
		mv $wallpaper $lixeira
	fi
fi

#echo $desktop
